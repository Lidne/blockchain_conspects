# Введение в Блокчейн
<sup>*черновая версия, в дальнейшем конспект станет подробнее*<sup>

## Зачем нужна эта лекция
- Решение изменить программу курса, чтобы важный материал (например, код смарт-контрактов) студенты могли изучать в начале семестра, а не в конце.
- В начале курса будет дано общее понимание блокчейнов, смарт-контрактов, затем переход к более детальным темам (криптография, консенсусы и т.д.).

## Основные компоненты публичных блокчейнов
- Блокчейн можно представить как пиринговую сеть, где компьютеры (ноды) обмениваются информацией о транзакциях.
- Каждая нода сети выполняет одинаковые действия согласно протоколу, независимо от того, подключены ли все другие ноды.
  
## Пример на основе финансов
- В банковских системах транзакции записываются в базы данных, а репликация (например, через алгоритмы Raft или Paxos) поддерживает консистентность данных.
- Блокчейны решают проблему «двойной траты» (double spend) с помощью механизма консенсуса, который защищает от византийских атак (Byzantine Fault Tolerance).

## Byzantine Fault Tolerance (BFT)
- Блокчейны устойчивы к наличию злонамеренных нод, которые пытаются подорвать сеть.
- Основное условие: больше двух третей нод сети должны быть честными.
- Алгоритмы консенсуса (например, Proof of Work, Proof of Stake) обеспечивают согласованность состояния сети даже в случае злонамеренных участников.

## Как работают блоки и транзакции
- Транзакции пользователей распространяются по сети и включаются в блоки.
- После получения блока, каждая нода проверяет его валидность и добавляет его транзакции в свою базу данных состояния (StateDB).
- Блоки в блокчейне связаны с помощью хэшей: каждый новый блок содержит хэш предыдущего блока.
- Откаты (rollback) транзакций возможны в случае конфликта или несогласованности в цепочке блоков.

## Цепочка блоков (DAG)
- Блокчейн можно представить как направленный ациклический граф (DAG), где каждый блок ссылается на предыдущий.
- Алгоритмы консенсуса выбирают, какой блок будет считаться правильным в случае появления конкурирующих блоков (forks).
  
---

## Криптографические основы блокчейна

### Хэширование
- Хэширование обеспечивает уникальную идентификацию данных.
- Криптографические хэши обладают двумя важными свойствами:
  - Рассеивание (diffusion): изменение одного бита исходного текста сильно влияет на весь хэш.
  - Перемешивание (confusion): изменение одного бита ключа сильно влияет на результат хэширования.
- Хэши блоков и транзакций позволяют гарантировать, что данные не были изменены.

### Цифровая подпись
- Используется асимметричная криптография: у пользователя есть публичный и приватный ключи.
- Приватный ключ используется для подписи транзакций, а публичный — для проверки подписи.
- В блокчейнах электронные подписи используются для проверки транзакций: нода проверяет, что транзакция подписана правильным приватным ключом.

## Консенсус и валидаторы
- В современных алгоритмах Proof of Stake ноды-валидаторы производят блоки, а другие ноды подтверждают их правильность с помощью цифровых подписей.
- Блок считается финализированным, когда большинство нод подтверждают его корректность.